webpackJsonp([10],{"0yZr":function(e,t){e.exports={title:"title",primary:"primary","bg-primary":"bg-primary",green:"green",yellow:"yellow","light-yellow":"light-yellow","placeholder-text":"placeholder-text","bg-yellow":"bg-yellow",red:"red","bg-red":"bg-red",right:"right",center:"center","space-between":"space-between",container:"container","modal-wrap":"modal-wrap","select-wrap":"select-wrap","modal-title":"modal-title",input:"input",button:"button","phone-input":"phone-input","media-wrap":"media-wrap"}},bm2n:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n("nvbp"),o=n.n(s),r=n("Dd8w"),i=n.n(r),c=n("7+uW"),a=n("iO/v"),h=n("NYxO"),d=n("i1rO"),l=c.default.component("sunmi-checkModal",{props:{},data:function(){return{phone:"",password:"",checkCode:"",btn:!1,isActive:!1,isErr:!1,isEmailErr:!1,isPwdErr:!1,errMsg:this.$t("personalCenter.errEnterPhoneMsg"),areaCode:86,checkCodeTxt:this.$t("personalCenter.sendCheckCode"),second:60,maxSecond:60,time:0,loading:!1}},mounted:function(){this.$store.dispatch("personalCenter/getCountriesList")},beforeDestroy:function(){this.timer&&clearInterval(this.timer)},computed:i()({},Object(h.b)({countryList:"personalCenter/countryList",checkBoxErr:"personalCenter/checkBoxErr",showCheckBoxCode:"personalCenter/phoneshowCheckBoxCode",imgCode:"personalCenter/imgCode",phoneSendTime:"personalCenter/phoneSendTime"})),methods:{resetImg:function(){this.$store.dispatch("personalCenter/getImgCode")},change:function(){this.btn=!!this.phone&&!!this.password&&!!this.checkCode&&4===this.checkCode.length},submit:function(){var e=this;this.isEmailErr=!1,this.isErr=!1,this.isPwdErr=!1,this.loading=!0,this.$store.dispatch("personalCenter/checkPhone",{password:Object(d.c)(this.password),phone:this.phone,phoneCode:this.checkCode,type:this.$isPc?1:2,areaCode:this.areaCode}).then(function(){e.cancleModalHandler(),e.$Msg.show({type:"success",content:e.$t("common.changeSuccess")}),e.$store.dispatch("home/getUserInfo")}).catch(function(t){switch(+t.code){case 2003:e.isEmailErr=!0;break;case 201:e.isPwdErr=!0}}).finally(function(){e.loading=!1})},oninputChange:function(e){this.phone=e,this.change(),this.checkedPhone()},onareachange:function(e){this.areaCode=e.callingCode,this.checkedPhone()},checkedPhone:function(){var e=86===this.areaCode?/^1[0-9]{10}$/:/^\d{5,20}$/,t=this.phone.match(e);this.isErr=!t||!this.phone,this.isActive=!this.isErr&&this.second===this.maxSecond},cancleCheckHandler:function(){this.$store.commit("personalCenter/HIDE_CHECK_BOX_CODE")},checkCodeDone:function(e){this.sendPhoneCode({phone:this.phone,type:1,areaCode:this.areaCode,imgCode:e,captchaKey:this.imgCode.captchaKey})},sendPhoneCode:function(e){var t=this;this.$store.dispatch("personalCenter/sendCheckCode",e).then(function(){t.isActive=!1,t.isErr=!1;t.timer=setInterval(function e(){if(t.second)return t.checkCodeTxt=t.$t("personalCenter.sendRepeat")+"("+t.second+"s)",t.second=t.second-1,e;t.second=t.maxSecond,t.checkCodeTxt=t.$t("personalCenter.sendCheckCode"),t.checkedPhone(),clearInterval(t.timer)}(),1e3)}).catch(function(e){switch(console.log(e),+e.code){case 306:t.isErr=!0,t.$store.commit("personalCenter/HIDE_CHECK_BOX_CODE"),t.errMsg=t.$t("common.frequentRequest");break;case 2061:t.isErr=!0,t.errMsg=t.$t("personalCenter.phoneBundled")}})},cancleModalHandler:function(){this.$router.replace("/personalCenter")},send:function(){this.second===this.maxSecond&&this.phone&&this.sendPhoneCode({phone:this.phone,type:1,areaCode:this.areaCode})}},render:function(e){var t=this;return e("div",[e(a.l,o()([{attrs:{visiable:!0,hasHeader:!0,onlyClose:!0},on:{cancleHandler:this.cancleModalHandler}},{on:i()({},this.$listeners),attrs:i()({},this.$attrs)}]),[e("div",{class:"modal-wrap"},[e("div",{class:" title modal-title"},[this.$t("personalCenter.checkPhone")]),e(a.i,o()([{attrs:{type:"password",value:t.password},class:"input",on:{input:function(e){t.password=e}}},{directives:[{name:"model",value:t.password}]},{attrs:{placeholder:this.$t("personalCenter.enterPassword"),isErr:this.isPwdErr,errMsg:this.$t("personalCenter.passwordErr")},on:{"on-change":this.change}}])),e(a.o,{attrs:{countryList:this.countryList,isErr:this.isErr,errMsg:this.errMsg},on:{onareachange:this.onareachange,oninputChange:this.oninputChange}}),e(a.i,o()([{class:"input",attrs:{value:t.checkCode},on:{input:function(e){t.checkCode=e}}},{directives:[{name:"model",value:t.checkCode}]},{attrs:{placeholder:this.$t("personalCenter.enterCheck"),isErr:this.isEmailErr,errMsg:this.$t("personalCenter.checkErrMsg"),maxlength:4,isActive:this.isActive},on:{"on-change":this.change}}]),[e("span",{slot:"suffix",class:"sendCheckCode",on:{click:this.send}},[this.checkCodeTxt])]),e(a.h,{attrs:{isShow:this.btn,loading:this.loading},class:"button",on:{click:this.submit}},[this.$t("personalCenter.submit")]),e(a.e,{attrs:{visiable:this.showCheckBoxCode,isErr:this.checkBoxErr,url:this.imgCode.url},on:{cancleHandler:this.cancleCheckHandler,checkCodeDone:this.checkCodeDone,resetImg:this.resetImg}})])])])}});var p=n("VU/8")(l,null,!1,function(e){n("0yZr")},"data-v-2e09934a",null);t.default=p.exports}});