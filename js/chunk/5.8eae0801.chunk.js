webpackJsonp([5],{"2K16":function(e,t){e.exports={title:"title",primary:"primary","bg-primary":"bg-primary",green:"green",yellow:"yellow","light-yellow":"light-yellow","placeholder-text":"placeholder-text","bg-yellow":"bg-yellow",red:"red","bg-red":"bg-red",right:"right",center:"center","space-between":"space-between",container:"container","modal-wrap":"modal-wrap","modal-title":"modal-title",input:"input",button:"button","media-wrap":"media-wrap"}},B9Yj:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s("nvbp"),n=s.n(i),r=s("Dd8w"),a=s.n(r),o=s("7+uW"),c=s("iO/v"),l=s("NYxO"),h=s("i1rO"),d=o.default.component("sunmi-emailModal-phone",{props:{},data:function(){return{email:"",password:"",check:"",loading:!1,btn:!1,isEmailErr:!1,errEmailMsg:this.$t("personalCenter.emailErr"),isPasswordErr:!1,isCheckErr:!1,isActive:!1,second:60,checkCodeTxt:this.$t("personalCenter.sendCheckCode")}},computed:a()({},Object(l.b)({checkBoxErr:"personalCenter/checkBoxErr",showCheckBoxCode:"personalCenter/showCheckBoxCode",imgCode:"personalCenter/imgCode"})),methods:{change:function(){this.btn=!!this.email&&!!this.password&&!this.isEmailErr&&4===this.check.length},emailChange:function(){this.checkEmail(),this.change()},resetImg:function(){this.$store.dispatch("personalCenter/getImgCode")},cancleCheckHandler:function(){this.$store.commit("personalCenter/HIDE_CHECK_BOX_CODE")},cancleModalHandler:function(){this.$router.replace("/personalCenter")},submit:function(){var e=this;this.isCheckErr=!1,this.isPasswordErr=!1,this.loading=!0,this.$store.dispatch("personalCenter/changeEmail",{password:Object(h.c)(this.password),newEmail:this.email,type:this.$isPc?1:2,code:this.check}).then(function(){e.$Msg.show({type:"success",content:e.$t("common.changeSuccess")}),e.cancleModalHandler(),e.$store.dispatch("home/getUserInfo")}).catch(function(t){switch(+t.code){case 201:e.isPasswordErr=!0;break;case 2003:e.isCheckErr=!0}}).finally(function(){e.loading=!1})},checkEmail:function(){var e=/^[A-Za-z0-9]+([-_.][A-Za-z0-9]+)*@([A-Za-z0-9]+[-.])+[A-Za-z0-9]{2,5}$/;this.isEmailErr=!this.email.match(e)&&!!this.email,this.isActive=!!this.email.match(e)&&60===this.second},sendEmailCode:function(e){var t=this;this.$store.dispatch("personalCenter/sendEmailCode",e).then(function(){if(t.cancleCheckHandler(),60===t.second){t.isActive=!1;t.timer=setInterval(function e(){return t.second?(t.checkCodeTxt=t.$t("personalCenter.sendRepeatTime",{time:t.second}),t.second=t.second-1):(t.second=60,t.isActive=!0,t.checkCodeTxt=t.$t("personalCenter.sendCheckCode"),t.timer&&clearInterval(t.timer)),e}(),1e3)}}).catch(function(e){switch(+e.code){case 3520:t.$Msg.show({type:"error",content:t.$t("personalCenter.noLogin"),onClose:function(){t.$router.push("/login")}});break;case 204:t.isEmailErr=!0,t.errEmailMsg=t.$t("personalCenter.emailBundled")}})},checkCodeDone:function(e){this.sendEmailCode({email:this.email,lang:"zh"===this.$i18n.locale?"CN":"EN",type:1,imgCode:e,captchaKey:this.imgCode.captchaKey})},sendCode:function(){this.isActive&&this.email&&this.sendEmailCode({email:this.email,lang:"zh"===this.$i18n.locale?"CN":"EN",type:1})}},render:function(e){var t=this;return e("div",[e(c.l,n()([{attrs:{visiable:!0,hasHeader:!0,onlyClose:!0},on:{cancleHandler:this.cancleModalHandler}},{on:a()({},this.$listeners),attrs:a()({},this.$attrs)}]),[e("div",{class:"modal-wrap"},[e("div",{class:"modal-title title"},[this.$t("personalCenter.changeEmail")]),e(c.i,n()([{class:"input",attrs:{value:t.password},on:{input:function(e){t.password=e}}},{directives:[{name:"model",value:t.password}]},{attrs:{placeholder:this.$t("personalCenter.enterPassword"),isErr:this.isPasswordErr,errMsg:this.$t("personalCenter.passwordErr"),type:"password"},on:{"on-change":this.change}}])),e(c.i,n()([{class:"input",attrs:{value:t.email},on:{input:function(e){t.email=e}}},{directives:[{name:"model",value:t.email}]},{attrs:{placeholder:this.$t("personalCenter.enterNewEmail"),isErr:this.isEmailErr,errMsg:this.errEmailMsg},on:{"on-change":this.emailChange}}])),e(c.i,n()([{attrs:{placeholder:this.$t("personalCenter.enterCheck"),isErr:this.isCheckErr,errMsg:this.$t("personalCenter.emailCheck"),maxlength:4,value:t.check},on:{"on-change":this.change,input:function(e){t.check=e}},class:"input"},{directives:[{name:"model",value:t.check}]},{attrs:{maxlength:4,isActive:this.isActive}}]),[e("span",{on:{click:this.sendCode},slot:"suffix"},[this.checkCodeTxt])]),e(c.h,{attrs:{loading:this.loading,isShow:this.btn},class:"button",on:{click:this.submit}},[this.$t("personalCenter.submit")])]),e(c.e,{attrs:{visiable:this.showCheckBoxCode,isErr:this.checkBoxErr,url:this.imgCode.url},on:{cancleHandler:this.cancleCheckHandler,checkCodeDone:this.checkCodeDone,resetImg:this.resetImg}})])])}});var m=s("VU/8")(d,null,!1,function(e){s("2K16")},"data-v-b6f6ba22",null);t.default=m.exports}});